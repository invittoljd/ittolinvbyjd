import{a as S}from"./chunk-VVGBZAEW.js";import{e as P}from"./chunk-NBS3JSTV.js";import{Ca as u,Ea as p,Ga as v,Ha as d,Ia as b,La as w,M as g,Ma as I,Na as k,Ra as x,S as c,Ta as C,V as y,c as a,ib as E,kb as _,pb as U,ra as h,ub as l}from"./chunk-EGZLEYQ3.js";var R=(()=>{let e=class e{constructor(){this.apiUrl=`${l.url}/api/auth`,this.http=c(U),this._cookieService=c(S),this._router=c(P)}signIn(r,t,i){return a(this,null,function*(){try{let s=yield this.http.post(this.apiUrl+"/register",{username:r,password:t,type:i}).toPromise();if(s){let{message:n,ok:f}=s;if(f)return!0;this.showError("Error al hacer el login:",n)}}catch(s){this.showError("Error al realizar la solicitud:",s)}return!1})}logIn(r,t){return a(this,null,function*(){try{let i=yield this.http.post(this.apiUrl+"/login",{username:r,password:t,keep:!1}).toPromise();if(i){let{message:s,token:n}=i;if(n)return this._cookieService.set(l.tokenName,n,void 0,"/"),!0;this.showError("Error al hacer el login:",s)}}catch(i){this.showError("Error al realizar la solicitud:",i)}return!1})}getUserInfo(){return a(this,null,function*(){if(this._cookieService.get(l.tokenName)){let t=yield this.http.get(this.apiUrl+"/getUserInfo").toPromise(),{type:i,username:s}=t,n={type:i,username:s};if(t)return n}return{}})}logOut(){return a(this,null,function*(){this._cookieService.deleteAll(),this._router.navigate([""])})}getUsers(){return a(this,null,function*(){try{let r=yield this.http.get(this.apiUrl+"/getUsers").toPromise();if(r){let{users:t}=r;return t}}catch{}return[]})}deleteUser(r,t,i){return a(this,null,function*(){try{if(yield this.http.delete(this.apiUrl+"/"+t._id,{body:{deleteAll:i}}).toPromise()){let n=r.findIndex(f=>f._id===t._id);return n!==-1&&r.splice(n,1),!0}}catch{}return!1})}showError(r,t){console.log("Error en el archivo: auth.service.ts"),console.log(r,`
	`,l.showErrors?t:"")}};e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=g({token:e,factory:e.\u0275fac,providedIn:"root"});let o=e;return o})();var N=o=>[o];function j(o,e){o&1&&b(0,"button",4)}function T(o,e){if(o&1&&(v(0,"div",1)(1,"p",2),I(2),d(),u(3,j,1,0,"button",3),d()),o&2){let m=w();p("ngClass",C(3,N,m.alert.type)),h(2),k(m.alert.text),h(),p("ngIf",!m.alert.keep)}}var G=(()=>{let e=class e{};e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=y({type:e,selectors:[["app-alert"]],inputs:{alert:"alert"},standalone:!0,features:[x],decls:1,vars:1,consts:[["class","mt-2 mb-2 alert alert-dismissible fade show text-center","role","alert",3,"ngClass",4,"ngIf"],["role","alert",1,"mt-2","mb-2","alert","alert-dismissible","fade","show","text-center",3,"ngClass"],[1,"m-0","fw-bold"],["type","button","class","btn-close","data-bs-dismiss","alert","aria-label","Close",4,"ngIf"],["type","button","data-bs-dismiss","alert","aria-label","Close",1,"btn-close"]],template:function(t,i){t&1&&u(0,T,4,5,"div",0),t&2&&p("ngIf",i.alert)},dependencies:[_,E]});let o=e;return o})();export{R as a,G as b};
